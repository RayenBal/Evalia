<!-- ==== NAVBAR ==== -->
<!-- Si connecté -->
<ng-container *ngIf="auth.isAuthenticated(); else publicNavbar">

  <!-- Si connecté & annonceur -->
  
    <!-- NAVBAR Annonceur -->
  <nav style="background: white; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 1000;">
    <div class="container-modern" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem;">
      <a style="text-decoration: none; cursor: pointer;" routerLink="/annonceur/home">
      <img src="assets/logo-annonceur.png" alt="EVALIA Annonceur" style="height: 90px; width: auto;">
      </a>

         <ul style="display: flex; list-style: none; gap: 2rem; margin: 0; align-items: center; flex-wrap: wrap;">
      <!-- Icône de Notification -->
      <li style="position: relative;">
        <a routerLink="/annonceur/notifications" class="nav-link-modern" style="position: relative; display: inline-block;">
          <i class="bi bi-bell icon-md" style="font-size: 1.5rem;"></i>
          <!-- Badge de notification -->
          <span style="position: absolute; top: -8px; right: -8px; background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);">
            3
          </span>
        </a>
      </li>
      <li><a routerLink="/profile" class="nav-link-modern"><i class="bi bi-person icon-sm"></i> Mon profil</a></li>
      <li *ngIf="!auth.isPaneliste">
        <a routerLink="/reclamations/new" class="nav-link-modern" routerLinkActive="active">
          <i class="bi bi-file-earmark-text icon-sm"></i> Ajouter une réclamation
        </a>
        
      </li>
            <li><a routerLink="/reclamations" class="nav-link-modern"><i class="bi bi-clipboard-check icon-sm"></i> Mes Réclamations</a></li>

      <li><a routerLink="/announcements" class="nav-link-modern"><i class="bi bi-megaphone icon-sm"></i> Les Annonces</a></li>
      <li *ngIf="selectedId"><a [routerLink]="['/owner/announces', selectedId, 'rewards']" class="nav-link-modern"><i class="bi bi-gift icon-sm"></i> Récompenses</a></li>
    </ul>

      <button class="btn-modern btn-danger-pastel" (click)="logout()">
        <i class="bi bi-box-arrow-right icon-sm"></i> Déconnexion
      </button>
    </div>
  </nav>

  <!-- NAVBAR Paneliste -->
  <ng-template #panelisteNavbar>
 <nav style="background: white; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 1000;">
  <div class="container-modern" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem;">
    <a style="text-decoration: none; cursor: pointer;" routerLink="/paneliste/home">
      <img src="assets/logo-evalia.png" alt="EVALIA" style="height: 90px; width: auto;">
    </a>

    <ul style="display: flex; list-style: none; gap: 2rem; margin: 0; align-items: center;">
      <!-- Icône de Notification -->
      <li style="position: relative;">
        <a routerLink="/paneliste/notifications" class="nav-link-modern" style="position: relative; display: inline-block;">
          <i class="bi bi-bell icon-md" style="font-size: 1.5rem;"></i>
          <!-- Badge de notification -->
          <span style="position: absolute; top: -8px; right: -8px; background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);">
            5
          </span>
        </a>
      </li>
      <li><a routerLink="/profile" class="nav-link-modern"><i class="bi bi-person icon-sm"></i> Mon profil</a></li>
      <li *ngIf="auth.isPaneliste"><a routerLink="/reclamations/new" class="nav-link-modern" routerLinkActive="active"><i class="bi bi-file-earmark-plus icon-sm"></i> Ajouter une réclamation</a></li>
      <li><a routerLink="/reclamations" class="nav-link-modern"><i class="bi bi-clipboard-check icon-sm"></i> Mes Réclamations</a></li>
      <li><a routerLink="/me/rewards" class="nav-link-modern"*ngIf="auth.isAuthenticated() && auth.isPaneliste"><i class="bi bi-gift icon-sm"></i> Mes Récompenses</a></li>
    </ul>

    <button class="btn-modern btn-danger-pastel" (click)="logout()">
      <i class="bi bi-box-arrow-right icon-sm"></i> Déconnexion
    </button>
  </div>
</nav>
  </ng-template>

</ng-container>

<!-- Si NON connecté -->
<ng-template #publicNavbar>
  <nav style="background: white; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 1000;">
    <div class="container-modern" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem;">
      <!-- Logo -->
      <a routerLink="/" style="text-decoration: none;">
        <img src="assets/logo-evalia.png" alt="EVALIA" style="height: 90px; width: auto;">
      </a>

      <!-- Navigation -->
      <ul style="display: flex; list-style: none; gap: 2rem; margin: 0; align-items: center;">
        <li>
          <a routerLink="/" class="nav-link-modern">
            <i class="bi bi-house-door" style="margin-right: 0.5rem;"></i> Home
          </a>
        </li>
        <li>
          <a routerLink="/CategoryList" class="nav-link-modern">
            <i class="bi bi-folder2-open" style="margin-right: 0.5rem;"></i> Catégories
          </a>
        </li>
        <li>
          <a routerLink="/announcements" class="nav-link-modern">
            <i class="bi bi-megaphone" style="margin-right: 0.5rem;"></i> Annonces
          </a>
        </li>
      </ul>

      <!-- Boutons d'authentification -->
      <div style="display: flex; gap: 0.75rem;">
        <a routerLink="/login" class="btn-modern btn-outline-pastel">Sign in</a>
        <a routerLink="/register" class="btn-modern btn-primary-pastel">Sign up</a>
      </div>
    </div>
  </nav>
</ng-template>



<div class="container-modern" style="padding: 2rem 1rem; min-height: 100vh;">
  
  <!-- Bouton Retour -->
  <a  class="btn-modern btn-secondary-pastel animate-fade-in" style="display: inline-flex; align-items: center; gap: 0.5rem; margin-bottom: 2rem;" (click)="goBack()">
    <i class="bi bi-arrow-left icon-sm"></i> Retour
  </a>

  <!-- Loading -->
  <ng-container *ngIf="loading">
    <div class="spinner-pastel" style="margin: 4rem auto;"></div>
  </ng-container>

  <!-- Erreur -->
  <ng-container *ngIf="!loading && error">
    <div class="card-modern animate-scale-in" style="padding: 2rem; text-align: center; border-left: 4px solid var(--pastel-red);">
      <i class="bi bi-exclamation-triangle icon-xl" style="color: var(--pastel-red); margin-bottom: 1rem;"></i>
      <p style="color: var(--pastel-red); font-weight: 600; font-size: 1.125rem; margin: 0;">{{ error }}</p>
    </div>
  </ng-container>

  <!-- Contenu principal -->
  <ng-container *ngIf="!loading && !error && category">
    
    <!-- En-tête de la catégorie -->
    <div class="card-modern animate-fade-in" style="padding: 2rem; margin-bottom: 2rem; text-align: center;">
      <i class="bi bi-folder2-open icon-xl icon-circle-lg" style="color: var(--pastel-blue-600); margin-bottom: 1rem;"></i>
      <h1 class="text-gradient" style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">
        {{ category.nameCategory }}
      </h1>
      <p style="color: #6B7280;">Liste des annonces de cette catégorie</p>
    </div>

    <!-- Titre des annonces -->
    <div class="header-section animate-fade-in" style="margin-bottom: 2rem;">
      <h2 class="text-gradient" style="font-size: 1.75rem; font-weight: 700; display: flex; align-items: center; gap: 0.75rem;">
        <i class="bi bi-megaphone icon-lg"></i>
        Annonces ({{ announces.length }})
      </h2>
      <div class="divider-pastel"></div>
    </div>

    <!-- Message si vide -->
    <div *ngIf="announces.length === 0" class="card-modern animate-scale-in" style="padding: 3rem; text-align: center;">
      <i class="bi bi-inbox icon-xl" style="color: var(--pastel-blue-400); display: block; margin-bottom: 1rem;"></i>
      <p style="color: #6B7280; font-size: 1.125rem; margin: 0;">Aucune annonce dans cette catégorie.</p>
    </div>

    <!-- Grille des annonces -->
    <div class="grid-modern" *ngIf="announces.length > 0">
      <div *ngFor="let a of announces; let i = index" class="card-announce animate-scale-in" [style.animation-delay]="(i * 0.1) + 's'">
        
        <!-- Image -->
        <a [routerLink]="['/announcementPaneliste/details', a.idAnnouncement]">
          <img
            class="img-modern"
            [src]="a.image ? getImageUrl(a.image) : 'assets/no-image.png'"
            [alt]="a.announceName"
            style="width: 100%; height: 200px; object-fit: cover; border-radius: var(--radius-lg) var(--radius-lg) 0 0;"
          />
        </a>

        <!-- Contenu -->
        <div style="padding: 1.5rem;">
          <h3 class="text-gradient" style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.75rem;">
            {{ a.announceName }}
          </h3>
          
          <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
            <span *ngIf="a.deliveryAddress" class="badge-pastel badge-blue" style="display: flex; align-items: center; gap: 0.25rem;">
              <i class="bi bi-truck icon-sm"></i> {{ a.deliveryAddress }}
            </span>
            <span *ngIf="a.officeAddress" class="badge-pastel badge-purple" style="display: flex; align-items: center; gap: 0.25rem;">
              <i class="bi bi-building icon-sm"></i> {{ a.officeAddress }}
            </span>
          </div>

          <p style="color: #6B7280; margin-bottom: 1.5rem; line-height: 1.6; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
            {{ a.content }}
          </p>

          <!-- Bouton d'action -->
          <a class="btn-modern btn-primary-pastel" [routerLink]="['/announcementPaneliste/details', a.idAnnouncement]" style="width: 100%; justify-content: center;">
            <i class="bi bi-eye icon-sm"></i> Voir & répondre aux quiz
          </a>
        </div>
      </div>
    </div>
  </ng-container>
</div>
