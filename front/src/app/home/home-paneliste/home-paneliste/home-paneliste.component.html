<!-- NAVBAR MODERNE PANELISTE -->
<nav style="background: white; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 1000;">
  <div class="container-modern" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem;">
    <a style="text-decoration: none; cursor: pointer;" routerLink="/paneliste/home">
      <img src="assets/logo-evalia.png" alt="EVALIA" style="height: 90px; width: auto;">
    </a>

    <ul style="display: flex; list-style: none; gap: 2rem; margin: 0; align-items: center;">
      <!-- Icône de Notification -->

      <li><a routerLink="/profile" class="nav-link-modern"><i class="bi bi-person icon-sm"></i> Mon profil</a></li>
        <li *ngIf="auth.isPaneliste">
        <a routerLink="/calendar"
           routerLinkActive="active"
           class="nav-link-modern">
          <i class="bi bi-calendar-week icon-sm"></i> Calendrier
        </a>
      </li>
      <li *ngIf="auth.isPaneliste"><a routerLink="/reclamations/new" class="nav-link-modern" routerLinkActive="active"><i class="bi bi-file-earmark-plus icon-sm"></i> Ajouter une réclamation</a></li>
      <li><a routerLink="/reclamations" class="nav-link-modern"><i class="bi bi-clipboard-check icon-sm"></i> Mes Réclamations</a></li>
      <li><a routerLink="/me/rewards" class="nav-link-modern"*ngIf="auth.isAuthenticated() && auth.isPaneliste"><i class="bi bi-gift icon-sm"></i> Mes Récompenses</a></li>
            <li style="position: relative; display:flex; align-items:center;">
  <app-notification-bell></app-notification-bell>
</li>
    </ul>

    <button class="btn-modern btn-danger-pastel" (click)="logout()">
      <i class="bi bi-box-arrow-right icon-sm"></i> Déconnexion
    </button>
  </div>
</nav>

<!-- CATEGORIES -->
<section style="background: linear-gradient(135deg, #E8F4F8 0%, #D5F5E3 100%); padding: 2rem 0; border-bottom: 1px solid #E0E0E0;">
  <div class="container-modern">
    <div class="animate-fade-in" style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
      <h5 style="margin: 0; font-weight: 700; color: #256F86; display: flex; align-items: center; gap: 0.5rem;">
        <i class="bi bi-folder2-open icon-md icon-blue"></i> Catégories :
      </h5>

      <ng-container *ngIf="categoryList?.length; else catsFallback">
        <a class="badge-pastel animate-scale-in"
           [class.badge-blue]="idx % 5 === 0"
           [class.badge-pink]="idx % 5 === 1"
           [class.badge-mint]="idx % 5 === 2"
           [class.badge-lavender]="idx % 5 === 3"
           [class.badge-peach]="idx % 5 === 4"
           [style.animation-delay]="(idx * 50) + 'ms'"
           style="cursor: pointer; text-decoration: none;"
           *ngFor="let c of categoryList; let idx = index"
           [routerLink]="['/categories', c.idcategory]">
          {{ c.nameCategory }}
        </a>
      </ng-container>

      <ng-template #catsFallback>
        <span style="color: #9E9E9E; font-style: italic;">Aucune catégorie.</span>
      </ng-template>
    </div>
  </div>
</section>

<!-- ANNONCES A REPONDRE -->
<section class="container-modern" style="padding-top: 3rem; padding-bottom: 3rem;">
  <div class="animate-fade-in" style="margin-bottom: 2rem;">
    <h2 class="text-gradient" style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">
      <i class="bi bi-chat-left-text icon-lg" style="margin-right: 0.5rem;"></i> Annonces auxquelles je peux répondre
    </h2>
    <p style="color: #757575; font-size: 1.1rem;">Découvrez les annonces disponibles</p>
  </div>

  <hr class="divider-pastel" />

  <div *ngIf="!answerable?.length" style="background: #B3E5FC; color: #01579B; padding: 2rem; border-radius: 0.75rem; text-align: center;">
    <i class="bi bi-info-circle icon-xl" style="display: block; margin: 0 auto 1rem; font-size: 3rem;"></i>
    <p style="margin: 0;">Aucune annonce à répondre pour le moment.</p>
  </div>

  <div class="grid-modern" *ngIf="answerable?.length">
    <div *ngFor="let a of answerable; let idx = index" class="card-announce" [style.animation-delay]="(idx * 100) + 'ms'">
      <a [routerLink]="['/announcementPaneliste/details', a.idAnnouncement]" style="display: block; text-decoration: none;">
        <img class="img-modern" [src]="getImageUrl(a.image)" [alt]="a.announceName || 'Annonce'" style="width: 100%; height: 200px; object-fit: cover; margin-bottom: 1rem;">
      </a>
      
      <div style="flex: 1;">
        <h5 style="color: #256F86; font-weight: 700; margin-bottom: 0.75rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" [title]="a.announceName">
          {{ a.announceName }}
        </h5>
        <p style="color: #616161; margin-bottom: 1rem; max-height: 3.5rem; overflow: hidden;">
          {{ a.content }}
        </p>

        <ng-container *ngIf="a.idAnnouncement && rewardsById[a.idAnnouncement!] as rw">
          <ng-container *ngIf="rw.text; else noRw">
            <span class="badge-pastel badge-mint" style="display: inline-flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
              <i class="bi bi-gift icon-sm"></i> {{ rw.text }}
            </span>
          </ng-container>
          <ng-template #noRw>
            <small style="color: #9E9E9E; font-style: italic; display: block; margin-bottom: 1rem;">— aucune récompense</small>
          </ng-template>
        </ng-container>
      </div>

      <a class="btn-modern btn-primary-pastel" 
         [routerLink]="['/announcementPaneliste/details', a.idAnnouncement]"
         style="width: 100%; justify-content: center; text-decoration: none;">
        <i class="bi bi-eye icon-sm"></i> Voir & répondre aux quiz
      </a>
    </div>
  </div>
</section>

<!-- MES FEEDBACKS -->


<!-- MES RECOMPENSES -->
<section class="container-modern" style="padding-top: 2rem; padding-bottom: 3rem;">
  <div class="animate-fade-in" style="margin-bottom: 2rem;">
    <h2 class="text-gradient" style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">
      <i class="bi bi-gift icon-lg" style="margin-right: 0.5rem;"></i> Mes récompenses
    </h2>
    <p style="color: #757575; font-size: 1.1rem;">Suivez vos gains et récompenses</p>
  </div>

  <hr class="divider-pastel" />

  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="card-modern animate-scale-in">
      <div style="display: flex; align-items: center; gap: 1rem;">
        <div class="icon-circle-lg" style="background: linear-gradient(135deg, #A3D3E3, #75BDD5);">
          <i class="bi bi-bullseye icon-xl" style="color: white;"></i>
        </div>
        <div>
          <small style="color: #757575; display: block; margin-bottom: 0.25rem;">Total Points</small>
          <h3 style="margin: 0; color: #256F86; font-weight: 800;">—</h3>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="rewards?.items?.length" class="table-modern card-modern animate-scale-in delay-100">
    <table>
      <thead>
        <tr>
          <th><i class="bi bi-megaphone icon-sm"></i> Annonce</th>
          <th><i class="bi bi-tag icon-sm"></i> Type</th>
<th style="width:150px;"><i class="bi bi-coin icon-sm"></i> Montant</th>
          <th><i class="bi bi-calendar icon-sm"></i> Date</th>
                    
          <th style="width:150px; text-align:center;"><i class="bi bi-bag-check icon-sm"></i> Statut</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of rewards.items; let idx = index" class="animate-fade-in" [style.animation-delay]="(idx * 50) + 'ms'">
          <td>
            <a [routerLink]="['/announcementPaneliste/details', r.announcementId]" style="color: #256F86; text-decoration: none; font-weight: 600;">
              {{ r.announcementName || 'Annonce' }}
            </a>
          </td>
          <td><span class="badge-pastel badge-blue">{{ r.rewardType || r.rewardType }}</span></td>
          <td>
            <ng-container [ngSwitch]="r.rewardType">
              <span *ngSwitchCase="'Points'">{{ r.amount }} pts</span>
              <span *ngSwitchDefault>{{ r.amount | number:'1.2-2' }} TND</span>
            </ng-container>
          </td>
          <td style="color: #757575;">{{ r.createdAt | date:'short' }}</td>
          <td style="text-align:center;">
            <span class="badge"
                  [class.bg-secondary]="r.status === 'PAS_ENCORE'"
                  [class.bg-success]="r.status === 'TRANSFERE'">
              {{ r.status === 'TRANSFERE' ? 'Transférée' : 'Pas encore' }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<!-- FOOTER -->
<footer style="background: linear-gradient(135deg, #E8F4F8 0%, #D5F5E3 100%); border-top: 2px solid #A3D3E3; padding: 3rem 0; margin-top: 3rem;">
  <div class="container-modern">
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
      
      <!-- Section À propos -->
      <div>
        <h4 style="color: #256F86; font-weight: 700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="bi bi-info-circle"></i> À propos d'Evalia
        </h4>
        <p style="color: #616161; line-height: 1.6; margin: 0;">
          Bienvenue sur notre plateforme, un lieu unique de rencontre entre annonceurs et panélistes.
          Nous avons créé cet espace pour favoriser un dialogue direct et constructif : les annonceurs peuvent présenter leurs produits, services ou campagnes, tandis que les panélistes partagent leurs avis, leurs idées et leurs expériences de manière libre et authentique.
        </p>
      </div>

      <!-- Section Contactez-nous -->
      <div>
        <h4 style="color: #256F86; font-weight: 700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="bi bi-envelope"></i> Contactez-nous
        </h4>
        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
          <!-- Email -->
          <a href="mailto:suppevalia@gmail.com" 
             style="color: #616161; text-decoration: none; display: flex; align-items: center; gap: 0.5rem; transition: color 0.2s;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-envelope-fill" style="color: #256F86;"></i>
            suppevalia&#64;gmail.com
          </a>
          
          <!-- Téléphone -->
          <a href="tel:+21698143895" 
             style="color: #616161; text-decoration: none; display: flex; align-items: center; gap: 0.5rem; transition: color 0.2s;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-telephone-fill" style="color: #256F86;"></i>
            +216 98 143 895
          </a>
          
          <!-- Facebook -->
          <a href="https://www.facebook.com/profile.php?id=61570772838854" 
             target="_blank"
             style="color: #616161; text-decoration: none; display: flex; align-items: center; gap: 0.5rem; transition: color 0.2s;"
             onmouseover="this.style.color='#1877F2'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-facebook" style="color: #1877F2;"></i>
            Page Facebook
          </a>
        </div>
      </div>

      <!-- Section Liens rapides -->
      <div>
        <h4 style="color: #256F86; font-weight: 700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="bi bi-link-45deg"></i> Liens rapides
        </h4>
        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
          <a routerLink="/paneliste/home" 
             style="color: #616161; text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.5rem;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-house-door"></i> Accueil
          </a>
          <a routerLink="/CategoryList" 
             style="color: #616161; text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.5rem;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-folder2-open"></i> Catégories
          </a>
          <a routerLink="/announcements" 
             style="color: #616161; text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.5rem;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-megaphone"></i> Annonces
          </a>
          <a routerLink="/recompenses" 
             style="color: #616161; text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.5rem;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-gift"></i> Mes Récompenses
          </a>
          <a routerLink="/reclamations" 
             style="color: #616161; text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.5rem;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-clipboard-check"></i> Mes Réclamations
          </a>
          <a routerLink="/profile" 
             style="color: #616161; text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.5rem;"
             onmouseover="this.style.color='#256F86'" 
             onmouseout="this.style.color='#616161'">
            <i class="bi bi-person"></i> Mon Profil
          </a>
        </div>
      </div>
    </div>

    <!-- Ligne de séparation -->
    <hr style="border: none; border-top: 1px solid rgba(37, 111, 134, 0.2); margin: 2rem 0;">

    <!-- Copyright -->
    <div style="text-align: center;">
      <p style="color: #757575; margin: 0; font-size: 0.95rem;">
        © {{ today | date:'yyyy' }} <span class="text-gradient" style="font-weight: 700;">Evalia</span> — Tous droits réservés
      </p>
    </div>
  </div>
</footer>
